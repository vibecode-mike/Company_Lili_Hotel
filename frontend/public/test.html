<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>API 測試</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>API 測試頁面</h1>
    <button onclick="test1()">測試 1: Fetch API</button>
    <button onclick="test2()">測試 2: Axios (相對路徑)</button>
    <button onclick="test3()">測試 3: Axios (完整配置)</button>
    <pre id="result"></pre>

    <script>
        const log = (msg) => {
            document.getElementById('result').textContent += msg + '\n';
        };

        // 測試 1: 使用 Fetch API
        async function test1() {
            document.getElementById('result').textContent = '測試 1: Fetch API\n';
            try {
                const response = await fetch('/api/v1/campaigns');
                const data = await response.json();
                log('✅ 成功！返回 ' + data.length + ' 筆資料');
                log(JSON.stringify(data[0], null, 2));
            } catch (error) {
                log('❌ 失敗: ' + error.message);
            }
        }

        // 測試 2: 使用 Axios 相對路徑
        async function test2() {
            document.getElementById('result').textContent = '測試 2: Axios 相對路徑\n';
            try {
                const response = await axios.get('/api/v1/campaigns');
                log('✅ 成功！返回 ' + response.data.length + ' 筆資料');
                log(JSON.stringify(response.data[0], null, 2));
            } catch (error) {
                log('❌ 失敗: ' + error.message);
                log('詳細: ' + JSON.stringify(error.response?.data || error.message));
            }
        }

        // 測試 3: 模擬前端配置
        async function test3() {
            document.getElementById('result').textContent = '測試 3: Axios 完整配置\n';
            const client = axios.create({
                baseURL: '/api/v1',
                timeout: 30000,
            });
            
            try {
                const response = await client.get('/campaigns');
                log('✅ 成功！返回 ' + response.data.length + ' 筆資料');
                log('完整 URL: ' + response.config.url);
                log('BaseURL: ' + response.config.baseURL);
                log(JSON.stringify(response.data[0], null, 2));
            } catch (error) {
                log('❌ 失敗: ' + error.message);
                log('請求 URL: ' + error.config?.url);
                log('BaseURL: ' + error.config?.baseURL);
            }
        }
    </script>
</body>
</html>
