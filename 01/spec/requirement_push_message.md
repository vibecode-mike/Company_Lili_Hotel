\# 活动与讯息推播（Push Message）



\## 1. 目的

为支援行銷活动的推广设置讯息模板，并决定讯息的排程、特定触发的时机，能够依据会员标签或行为分群来选择发送对象，让讯息在对的时间送给对的人，提升讯息整体的精准度与自动化，可有效控制广告预算并增加转换率。



---



\## 2. 核心功能



| 功能               | 描述                                                                                                                         |

|--------------------|------------------------------------------------------------------------------------------------------------------------------|

| 1. 建立讯息推播   | 可依基础会员标签筛选对象、设定时间排程，自动将讯息发送给目标会员。                                                           |

| 2. 讯息图文模板   | 使用者透過配置區（下拉、輸入框、圖片上傳等）設定內容，預覽區即時呈現視覺化效果，系統於背景自動生成 LINE Front-end Simulator JSON（無需手動貼上），並依該資料識別文字/圖文內容及互動設定，支援輪播、按鈕與標籤回收。 |

| 3. 讯息数据成效   | 提供讯息发送后的即时与历史成效指标，涵盖互动行为（开启次数、点击次数）与发送纪录。                                             |

| 4. 自动回应 Reply | 于顾客行为自动触发（如：欢迎讯息、关键字回复）。                                                                             |



---



\## 3. Stories（使用者故事）



| 编号       | 名称               | Story                                                                                                                         |

|------------|--------------------|------------------------------------------------------------------------------------------------------------------------------|

| S\_PM\_001   | 建立讯息推播       | 作为一位行銷人员，我希望建立讯息并支援排程推播，同时能够精准锁定目标受众并提前预估发送配额，以便高效部署和管理我的品牌行銷活动。 |

| S\_PM\_002   | 讯息图文模板       | 作为一位内容管理者，我希望有一套灵活的机制来建立多媒体、高互动性的讯息模板，维持用户对品牌的新鲜感与参与度，以利蒐集更多用户的行为数据。 |

| S\_PM\_003   | 讯息数据成效       | 作为一位行銷数据人员，我希望系统存取所有已发讯息的历史成效数据，以利分析用户对内容与互动的偏好，来为下个季度做行銷的优化与调整。 |

| S\_PM\_004   | 自动回应           | 作为一位使用者，我希望设定欢迎讯息，当用户加入本账号好友时自动触发，以利在第一时间与用户互动不疏漏，且可蒐集用户资讯支持 CRM（会员资料整合）。 |



---



\## 4. AC（验收标准）



\### 4.1 Story: S\_PM\_001 建立讯息推播

\- 使用者可以從已建立的（透過配置區設定並保存的）訊息圖文模板中選擇並建立群發訊息，預覽區維持同步渲染。

\- 讯息发送之前，支援讯息效果的即时模拟与预览功能。

\- 必须能够选择以下任一传送对象：所有好友、筛选目标对象（依据会员标签进行筛选，并支援包含或排除指定条件的组合逻辑）。

\- 会员标签资料来源为问卷系统，问卷栏位包含：生日月份（如：8、9、10月生日）、年龄区间（如：18-25 岁、26-35 岁）、居住地区（如：台北市、新北市）、性别（如：男、女）、或是由后台建立自订标签（如：VIP、黑名单）。

\- 使用者能够选择立即传送，或于指定发送日期（YYYY/MM/DD）与发送时间（HH:MM）进行排程传送。

\- **排程发送时间验证**：若讯息内容尚未完成或仍在草稿状态，且设定的排程时间早于当前时间，使用者点击「发送」时，系统会显示警告讯息（alert）：「排程发送时间不可早于现在时间点」，需要重新设定或更新排程时间才可发送。

\- 使用者可选择讯息特定的触发条件，如：加入好友期间的 7～29天。

\- 在确认发送前，系统必须显示此次讯息的预计发送好友人数、即当前可用讯息的配额用量。

\- **发送对象详细设定**：

&nbsp; 1. **发送对象：所有好友** - 讯息发送给 LINE OA 目前在系统中的所有会员，环形图显示绿色 100%（设定如：发送人数与百分比皆为 100%）。系统会即时与 LINE OA 目前状态确认，确认可发讯息数量。若已选定发送人数超过可发数量，「发送」按钮会变为灰色（disable），并提示讯息：「剩余发送人数已超过可发数量！」。此处需包含一个 Radiobutton 来确认发送对象为所有好友。

&nbsp; 2. **发送对象：选择筛选标签对象** - 当未设定筛选标签时，环形图显示绿色 0%（设定如：发送人数为 0）。使用者可点击「新增标签」来选择会员标签，打开弹窗后可通过输入关键字搜索标签，并可设定标签条件为「包含」或「不包含」。点击「确认」后，系统会即时计算符合条件的预计发送人数与百分比，同步确认 LINE OA 可发讯息数量。若预选发送人数超过可发数量，「发送」按钮会变为灰色（disable），并提示讯息：「剩余发送人数已超过可发数量！」。

\- 若可用讯息的配额用量 < 预计发送的好友人数，系统须阻挡发送行为，并向使用者显示明确的提示。

\- 当编辑到一半，离开视窗则弹窗提示。

\- 可以将未完成设定的群发讯息储存为草稿，并支援随时可开启编辑。



\### 4.2 Story: S\_PM\_002 讯息图文模板

\- 在配置區輸入內容、上傳素材並即時預覽，系統於背景產生 LINE 模擬器 JSON 並自動對應至下列 4 種訊息圖文模板類型（無需手動選擇或接觸 JSON）：



| 类型       | 类型名称         | 核心组成                          | 互动性 | 补充说明                                                                 |

|------------|------------------|-----------------------------------|--------|--------------------------------------------------------------------------|

| Template01 | 纯文字           | 文字\*                             | 无     | -                                                                        |

| Template02 | 文字按钮确认型   | 文字\* / 按钮                      | 有     | 按钮支援 3 种互动：1.开启网址 2.触发文字 3.触发图片                       |

| Template03 | 图片点击型       | 图片\* / 按钮                      | 有     | -                                                                        |

| Template04 | 图卡按钮型       | 图片\* / 标题\* / 内文 / 金额 / 按钮 | 有     | -                                                                        |



\- \*\*轮播图卡支援\*\*：适用于图片点击型、图卡按钮型模板，须支援多张轮播图卡（最多 9 张），且支援预览、编辑、图片排序调整、删除等操作（如：可从 5 张图卡中任意删除 1 张）。

\- \*\*图片点击型模板规则\*\*：图片为必填，可选择图面下方是否显示动作按钮；可调整按钮文字，每张轮播图可设定互动标签及用户点击后的互动结果。

\- \*\*图卡按钮型模板规则\*\*：图片与标题为必填，可选填内文描述/金额数值；可选择显示的文字按钮数量（最多 2 个），每张轮播图卡可设定互动标签及点击后的互动结果。

\- \*\*图片上传规则\*\*：所有涉及图片的模板皆可上传图片，图片比例应为 1:1，档案大小支援 1 MB 以下，可重新上传；若不符合 1:1 比例，系统採 Fill 填满处理以确保完整显示。

\- \*\*互动标签设定\*\*：每个模板可设定用于数据追踪的互动标签（选填，未来可支援 AI 推荐标签）。

\- \*\*动作按钮互动类型\*\*：系统须允许每个讯息模板设定动作按钮的互动类型（必填），提供 3 种选项，不同选项影响下方栏位的显示与必填规则：

&nbsp; 1. 开启网址：需填写 URL 栏位。

&nbsp; 2. 触发文字：需填写要发送的「讯息文字」栏位。

&nbsp; 3. 触发图片：需上传一张图片档案。

\- \*\*通知与预览设定\*\*：适用于文字按钮确认型、图片点击型、图卡按钮型模板，须设定「通知讯息」（用户透过 LINE APP 推播时收到的简短通知）与「讯息预览」（用户未进入对话窗前看到的讯息最后一行内容）。



\### 4.3 Story: S\_PM\_003 讯息数据成效

\- 以清单形式显示讯息发送清单，包含：缩图（无图片则为系统预设图）、传送时间、传送人数、部分讯息内容、开启次数（不重复已读次数）、点击次数（不重复互动按钮/连结触发次数）。

\- 系统须识别讯息的 4 种发送状态及可编辑性：排程发送（可编辑）、已发送（不可编辑）、草稿（可编辑）、发送失败（显示失败原因：讯息额度不足）。

\- **讯息列表状态分类详细说明**：

&nbsp; 1. **已发送（已发出）** - 显示所有已完成发送的讯息，每笔记录包含以下资讯：
&nbsp;&nbsp;&nbsp; - 讯息主题
&nbsp;&nbsp;&nbsp; - 对象资讯（包含会员标签与互动标签）
&nbsp;&nbsp;&nbsp; - 目标发送对象人数
&nbsp;&nbsp;&nbsp; - 发送时间
&nbsp;&nbsp;&nbsp; - 系统会持续与 LINE OA 回传的互动数据（已读数与点击数据）进行同步，并更新显示于列表中。
&nbsp;&nbsp;&nbsp; - 使用者可点击「详细」查看按钮，检视对象详细内容与实际发送人数。

&nbsp; 2. **已排程（已排程）** - 显示所有已设定排程但尚未发送的讯息，每笔记录包含以下资讯：
&nbsp;&nbsp;&nbsp; - 讯息主题
&nbsp;&nbsp;&nbsp; - 对象资讯（包含会员标签与互动标签）
&nbsp;&nbsp;&nbsp; - 预计发送对象人数
&nbsp;&nbsp;&nbsp; - 已设定的排程时间
&nbsp;&nbsp;&nbsp; - 当时间到达排程设定与系统时间一致时，系统会自动启动讯息发送流程，并将该讯息的状态从「已排程」更新为「已发送」。
&nbsp;&nbsp;&nbsp; - 发送后系统会开始侦测 LINE OA 回传的已读与点击数据；使用者可点击「编辑」查看按钮，在发送前可查看内容并更新排程设定。

&nbsp; 3. **草稿（草稿）** - 显示尚未发送的讯息草稿，每笔记录包含以下资讯：
&nbsp;&nbsp;&nbsp; - 讯息主题
&nbsp;&nbsp;&nbsp; - 对象资讯（包含会员标签与互动标签）
&nbsp;&nbsp;&nbsp; - 预计发送对象人数
&nbsp;&nbsp;&nbsp; - 已设定的排程时间（但尚未记录到排程队列中）
&nbsp;&nbsp;&nbsp; - 草稿讯息尚未放入排程队列，使用者进入编辑页点击「发送」时，系统会根据设定将状态更新为：
&nbsp;&nbsp;&nbsp;&nbsp; a. 若设定了未来的排程时间 → 状态变更为「已排程」
&nbsp;&nbsp;&nbsp;&nbsp; b. 若选择立即发送 → 状态变更为「已发送」
&nbsp;&nbsp;&nbsp; - 状态变更后，系统会开始侦测 LINE OA 回传的已读与点击数据；使用者可点击「编辑」查看按钮，查看内容并修改排程设定。

\- 支援依据讯息的传送时间进行筛选，允许带入起始时间或结束时间搜索历史讯息。

\- 点击任一讯息后，可进入详细页面，查看：广告成效趋势（折线图）、发送对象清单、完整讯息内容。



\### 4.4 Story: S\_RM\_004 自动回应 v0.3

\- 支援事先设定讯息回应内容，触发方式有 3 种：新好友欢迎讯息、输入关键字触发、选择指定时间触发。

&nbsp; - 新好友欢迎讯息：可设定触发讯息内容。

&nbsp; - 关键字触发讯息：可输入多组关键字（最多 20 组），收到匹配关键字时进行回复，触发的关键字会记录于后台。

&nbsp; - 指定时间触发：可选择指定日期区间或时间区间（如：非营业时间段触发）。

\- 讯息回应格式以纯文字为主，未来可选择插入讯息图文模板或上传图片档案。

\- 设定自动回应讯息至少 1 笔（最多 5 笔），支援新增或删除。

\- 支援发送前的效果即时预览。

\- 设定完成后，可选择停用或删除该讯息：停用则不启动触发，删除则无法复原需重新设定。

\- 设定完成后，可编辑该讯息内容，用户下次触发时启用更新后的内容。

\- 于讯息外部可查看讯息的停用/启用状态、回应类型（如：欢迎讯息 / 关键字 / 指定时间）。

\- **关键字冲突处理机制**：

&nbsp; 1. 系统将设定好的触发关键字与讯息同步到 LINE OA 回传时，当用户输入讯息与关键字相符时，自动回应对应的内容。

&nbsp; 2. 当多个关键字会因「创建时间」与「最后编辑时间」同时存在时，以创建时间较晚者为准。较晚的关键字会触发对应的内容，优先级以最新的关键字为准。

&nbsp; 3. 要强调新增或编辑关键字时，会显示于「触发的」栏位。

&nbsp; 4. 系统同步到 LINE OA 回传时，当传送的关键字与已存在的关键字相同（包含关键字完全相同、包含关系相同）时，系统会自动过滤冲突的关键字，只保留可触发的那一笔关键字设定，避免多重触发或编辑问题。

\- **状态处理规则**：

&nbsp; 1. 系统仅支持两种特殊回应类型：**一条回应**、**欢迎讯息**，同一时间只能启用一个活跃的「触发的」标签。

&nbsp; 2. 当使用者想要新增或编辑新的这两类讯息时，系统会显示确认讯息：
&nbsp;&nbsp;&nbsp; - **欢迎讯息**：「已经启用的是欢迎讯息，是否覆盖？」
&nbsp;&nbsp;&nbsp; - **一条回应**：「已经启用的是一条回应讯息，是否覆盖？」

&nbsp; 3. 使用者选择「确认」后，系统会自动将原本「触发的」状态的讯息停用，并启用新的这类讯息设定。

&nbsp; 4. 使用者在确认讯息中可选择：
&nbsp;&nbsp;&nbsp; - **确认**：将启用中的讯息停用，并启用新讯息设定
&nbsp;&nbsp;&nbsp; - **保存不覆盖**：保存新讯息，但不改变现有「触发的」讯息，新讯息保持为草稿或等待状态

