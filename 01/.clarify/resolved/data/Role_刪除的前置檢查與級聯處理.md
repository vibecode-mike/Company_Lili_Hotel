# 釐清問題

當角色（Role）已指派給管理員時，是否允許刪除該角色？若允許，如何處理已指派的關聯？

# 定位

ERM：Role 實體的刪除操作與 AdminRole 關聯表的級聯處理規則

# 多選題

| 選項 | 描述 |
|--------|-------------|
| A | 不允許刪除（顯示錯誤訊息「該角色已被 N 位管理員使用，無法刪除」） |
| B | 允許刪除，同時級聯刪除 AdminRole 關聯記錄（管理員失去該角色權限） |
| C | 允許刪除，但需管理員先手動解除所有關聯 |
| D | 軟刪除（標記為已刪除但保留資料，管理員權限不變） |
| Short | 提供其他簡短答案（<=5 字） |

# 影響範圍

影響角色管理 API 的刪除邏輯、AdminRole 關聯表的級聯規則、權限系統的完整性、以及管理員權限的安全性

# 優先級

High - 涉及權限系統的核心安全性與資料完整性

---

# 解決記錄

- **回答**：B - 允許刪除，同時級聯刪除 AdminRole 關聯記錄（管理員失去該角色權限）
- **更新的規格檔**：spec/erm.dbml
- **變更內容**：
  1. 更新 Role 實體的 Note 說明，新增完整的角色刪除規則：系統預設角色不可刪除，自訂角色可刪除並級聯刪除 AdminRole 和 RolePermission 關聯記錄，刪除前提示影響的管理員數量
  2. 更新 AdminRole 實體的 Note 說明，新增級聯刪除規則：當 Role 或 Admin 被刪除時，級聯刪除所有關聯的 AdminRole 記錄（ON DELETE CASCADE）
- **解決時間**：2025-11-14
