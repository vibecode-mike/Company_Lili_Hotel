# 釐清問題
Message 表的 `trigger_condition` 僅以註解示意「加入好友期間的 7～29 天」，未定義實際格式與使用情境。此欄位要如何編碼條件並驅動發送流程？

# 定位
ERM：spec/erm.dbml:123-141（Message.trigger_condition 欄位）

# 多選題
| 選項 | 描述 |
|--------|-------------|
| A | 採用結構化 JSON（例如 `{"type":"join_duration","min_days":7,"max_days":29}`），後端依欄位解析並決定是否發送。 |
| B | 僅儲存可讀字串（如 `加入好友 7-29 天`），提供前端顯示，實際條件由其他欄位或程式碼控制。 |
| C | 此欄位為預留欄位／已棄用，v0 版不應使用，建議先移除。 |
| Short | 其他方案（<=5字） |

# 影響範圍
- **群發邏輯**：決定是否需要在發送時解析條件並套用會員篩選。
- **API & 驗證**：影響建立/編輯訊息時的資料驗證、欄位格式與錯誤處理。
- **資料一致性**：若格式未定義，可能導致資料庫紀錄無法被正確解析或重現條件。

# 優先級
Medium — 影響特定條件推播的實作與驗證流程，需釐清後才能落實相關功能。

---
# 解決記錄

- **回答**：C - 此欄位為預留欄位，v0 版不實作，保留供未來擴充
- **更新的規格檔**：spec/erm.dbml
- **變更內容**：
  1. 更新 Message.trigger_condition 欄位定義，標註為「預留欄位，v0 版不實作，允許 NULL」
  2. 說明未來可能用途：動態條件篩選（如：加入好友 7-29 天、最後互動超過 30 天）
  3. 建議未來採用 JSON 格式（如：{"type":"join_duration","min_days":7,"max_days":29}）
  4. 明確 v0 版使用標籤系統實現相同需求（透過標籤規則自動維護會員分類）
  5. 更新 Message.Note，說明 v0 版篩選機制使用 target_type + target_filter（標籤篩選）
  6. 避免過度設計，降低 v0 版實作複雜度
