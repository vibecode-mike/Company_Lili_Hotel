# 釐清問題

MemberInteractionRecord 以 (member_id, tag_id, message_id) 判斷唯一性，但「同一會員點擊同一訊息」在多短時間內算重複觸發（不累計）？

# 定位

ERM：MemberInteractionRecord 實體的唯一性索引與觸發去重邏輯

# 多選題

| 選項 | 描述 |
|--------|-------------|
| A | 永久唯一（同一會員同一訊息只記錄一次，無時間限制） |
| B | 24 小時窗口（超過 24 小時後重新點擊視為新觸發） |
| C | 依會話窗口（同一對話期間視為重複，關閉對話後重新計算） |
| D | 無時間窗口（每次點擊都記錄，unique 索引僅防止同時重複插入） |
| Short | 提供其他簡短答案（<=5 字） |

# 影響範圍

影響互動標籤的觸發統計邏輯、unique 索引的設計目的、以及資料表增長速度

# 優先級

High - 涉及核心去重邏輯的語意定義，影響資料庫設計與統計正確性

---

# 解決記錄

- **回答**：A - 永久唯一（同一會員同一訊息只記錄一次，無時間限制）
- **更新的規格檔**：spec/erm.dbml
- **變更內容**：更新 MemberInteractionRecord 實體的 Note 說明，新增「重複觸發時間窗口：採用『永久唯一』策略」，包含：(1) 同一會員對同一訊息的同一標籤互動在系統生命週期內僅記錄一次、(2) 重複點擊時 unique 索引阻止插入並靜默處理、(3) 不同訊息的相同標籤可累計記錄、(4) 業務語意與資料表增長控制說明
- **解決時間**：2025-11-14
