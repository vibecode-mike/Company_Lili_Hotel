# 釐清問題

LINE 會員頭像圖片如何儲存？是儲存 LINE CDN URL、下載並儲存到本地，還是即時從 LINE 取得？

# 定位

Feature：spec/features/member_management.feature Rule 關於會員頭像顯示（約第6-17行）

# 多選題

| 選項 | 描述 |
|--------|-------------|
| A | 儲存 LINE 頭像 CDN URL，每次顯示時即時載入（可能失效） |
| B | 首次加入時下載頭像並儲存到本地，定期同步更新 |
| C | 混合模式：優先使用本地快取，失效時回 LINE 重新下載 |
| Short | 其他機制（<=5字）|

# 影響範圍

影響會員資料同步邏輯、圖片儲存空間規劃、頁面載入速度、CDN 依賴性，以及頭像更新即時性。

# 優先級

Low

---
# 解決記錄

- **回答**：A - 儲存 LINE 頭像 CDN URL，每次顯示時即時載入（與現有程式碼一致）
- **更新的規格檔**：spec/features/member_management.feature, spec/erm.dbml
- **變更內容**：
  1. 新增「LINE 會員頭像儲存機制」規則，說明儲存 LINE CDN URL 的行為：
     - 會員首次加入時從 LINE API 取得並儲存頭像 URL
     - 已有 URL 則不重複呼叫 LINE API
     - URL 為空時補抓取
     - 前端直接載入 CDN URL，失效時顯示預設頭像
  2. 更新 erm.dbml 的 Member.line_avatar 欄位說明，補充 URL 來源、儲存方式、前端載入邏輯
  3. 更新會員清單範例的 line_avatar 欄位為完整 URL 格式
- **技術實現依據**：line_app/app.py 的 fetch_line_profile() 與 maybe_update_member_profile() 函數
