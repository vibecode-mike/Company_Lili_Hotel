# F008: 權限快取失效策略

## 問題描述
admin_permission_management.feature 提到「動態權限配置即時生效」，但未說明實作機制。

## 相關規格
- Feature: admin_permission_management.feature - 動態權限即時生效
- Example: "管理員「admin002」無需重新登入即可立即獲得權限「message.send」"

## 技術考量
- 權限檢查頻率高，需要快取
- 權限變更需即時反映
- 多節點部署時的同步

## 影響範圍
- 系統效能
- 權限即時性
- 架構複雜度

## 選項
- [ ] A. 無快取 - 每次請求都查詢資料庫
- [ ] B. 短期快取 - 快取 1-5 分鐘，TTL 後自動失效
- [ ] C. 主動失效 - 權限變更時廣播失效訊號
- [ ] D. 版本控制 - 權限表維護版本號，快取檢查版本

## 優先級
**Medium** - 影響權限即時性與系統效能

---
# 解決記錄

- **回答**：C - 混合：事件驅動立即失效 + 背景定期清理（TTL 1 小時）
- **更新的規格檔**：01/spec/features/admin_permission_management.feature
- **變更內容**：新增權限快取失效策略：權限/角色變更時廣播事件、各節點立即清除相關快取；同時背景定期清理（1 小時 TTL）避免漏送事件，確保權限重新載入
